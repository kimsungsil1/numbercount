<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>숫자 음성 카운터</title>
    <style>
        /* 모바일 친화적인 디자인을 위한 CSS */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        h1 {
            text-align: center;
        }
        .container {
            max-width: 500px;
            margin: auto;
        }
        label {
            display: block;
            margin-top: 10px;
        }
        input, select, button {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            box-sizing: border-box;
        }
        #controls {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
        }
        #controls button {
            width: 48%;
            margin-top: 10px;
        }
        #counter {
            text-align: center;
            font-size: 2em;
            margin-top: 20px;
        }
        #textCounter {
            text-align: center;
            font-size: 1.5em;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>숫자 음성 카운터</h1>

        <!-- 기능 1: 숫자 범위 설정 -->
        <label for="startNumber">시작 숫자:</label>
        <input type="number" id="startNumber" value="1" min="1">

        <label for="endNumber">끝 숫자:</label>
        <input type="number" id="endNumber" value="100" min="1">

        <!-- 기능 2: 음성 속도 및 음량 조절 -->
        <label for="rate">음성 속도:</label>
        <input type="range" id="rate" min="0.5" max="2" value="1" step="0.1">
        <span id="rateValue">1</span>

        <label for="volume">음량:</label>
        <input type="range" id="volume" min="0" max="1" value="1" step="0.1">
        <span id="volumeValue">1</span>

        <!-- 기능 4: 숫자 표기 방식 선택 -->
        <label for="numberFormat">숫자 표기 방식:</label>
        <select id="numberFormat">
            <option value="digit">숫자 그대로</option>
            <option value="word">숫자 단어로</option>
        </select>

        <!-- 기능 6: 음성 선택 기능 -->
        <label for="voiceSelect">음성 선택:</label>
        <select id="voiceSelect"></select>

        <!-- 기능 3: 일시 정지 및 재개 기능 -->
        <div id="controls">
            <button id="startBtn">시작</button>
            <button id="pauseBtn">일시 정지</button>
            <button id="resumeBtn">재개</button>
            <button id="stopBtn">중지</button>
        </div>

        <!-- 숫자 표시 -->
        <div id="counter">0</div>
        <!-- 기능 5: 숫자를 문자로 변환하여 표시 -->
        <div id="textCounter"></div>
    </div>

    <script>
        let currentNumber = 1;
        let counting = false;
        let paused = false;
        let voices = [];
        const counterDisplay = document.getElementById("counter");
        const textCounterDisplay = document.getElementById("textCounter");
        const startNumberInput = document.getElementById("startNumber");
        const endNumberInput = document.getElementById("endNumber");
        const rateInput = document.getElementById("rate");
        const rateValue = document.getElementById("rateValue");
        const volumeInput = document.getElementById("volume");
        const volumeValue = document.getElementById("volumeValue");
        const numberFormatSelect = document.getElementById("numberFormat");
        const voiceSelect = document.getElementById("voiceSelect");

        // 기능 6: 음성 선택 기능 구현
        function populateVoiceList() {
            voices = window.speechSynthesis.getVoices();
            voiceSelect.innerHTML = '';
            voices.forEach((voice) => {
                const option = document.createElement('option');
                option.textContent = voice.name + ' (' + voice.lang + ')';
                option.value = voice.name;
                voiceSelect.appendChild(option);
            });
        }

        populateVoiceList();
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = populateVoiceList;
        }

        // 음성 속도 및 음량 값 표시 업데이트
        rateInput.addEventListener('input', () => {
            rateValue.textContent = rateInput.value;
        });
        volumeInput.addEventListener('input', () => {
            volumeValue.textContent = volumeInput.value;
        });

        // 숫자를 문자로 변환하는 함수 (기능 5 및 8)
        function numberToKorean(number) {
            const hanA = ["", "일", "이", "삼", "사", "오", "육", "칠", "팔", "구", "십"];
            const danA = ["", "십", "백", "천", "", "만", "억", "조", "경"];
            let result = "";
            let i = 0;
            while (number > 0) {
                let digit = number % 10;
                if (digit != 0) {
                    result = hanA[digit] + danA[i] + result;
                }
                number = Math.floor(number / 10);
                i++;
            }
            if (result === "") result = "영";
            return result;
        }

        // 숫자를 영어로 변환하는 함수 (기능 8)
        function numberToEnglish(number) {
            // 간단한 구현 (숫자 변환 라이브러리를 사용하는 것이 좋습니다)
            const toWords = (n) => {
                const a = ['','one','two','three','four','five','six','seven','eight','nine','ten',
                           'eleven','twelve','thirteen','fourteen','fifteen','sixteen','seventeen',
                           'eighteen','nineteen'];
                const b = ['','','twenty','thirty','forty','fifty','sixty','seventy','eighty','ninety'];
                if (n < 20) return a[n];
                if (n < 100) return b[Math.floor(n/10)] + (n%10 ? ' ' + a[n%10] : '');
                if (n < 1000) return a[Math.floor(n/100)] + ' hundred' + (n%100 ? ' ' + toWords(n%100) : '');
                if (n < 1000000) return toWords(Math.floor(n/1000)) + ' thousand' + (n%1000 ? ' ' + toWords(n%1000) : '');
                return n.toString();
            }
            return toWords(number);
        }

        // 숫자를 읽는 함수
        function speakNumber(number) {
            const utterance = new SpeechSynthesisUtterance();
            const selectedVoiceName = voiceSelect.value;
            utterance.voice = voices.find(voice => voice.name === selectedVoiceName);

            const lang = utterance.voice.lang;
            utterance.lang = lang;

            let textToSpeak = number.toString();
            let displayText = number.toString();

            // 기능 4 및 8: 숫자 표기 방식 및 다국어 숫자 변환
            if (numberFormatSelect.value === "word") {
                if (lang.startsWith('ko')) {
                    textToSpeak = numberToKorean(number);
                    displayText = textToSpeak;
                } else if (lang.startsWith('en')) {
                    textToSpeak = numberToEnglish(number);
                    displayText = textToSpeak;
                } else {
                    // 다른 언어의 경우 숫자 그대로 읽음
                    textToSpeak = number.toString();
                }
            }

            utterance.text = textToSpeak;
            utterance.rate = parseFloat(rateInput.value);
            utterance.volume = parseFloat(volumeInput.value);

            window.speechSynthesis.speak(utterance);

            // 기능 5: 숫자를 문자로 변환하여 표시
            counterDisplay.textContent = number;
            textCounterDisplay.textContent = displayText;
        }

        // 카운팅 시작 함수
        function startCounting() {
            if (counting) return;
            currentNumber = parseInt(startNumberInput.value);
            counting = true;
            paused = false;
            count();
        }

        // 카운팅 중지 함수
        function stopCounting() {
            counting = false;
            paused = false;
            window.speechSynthesis.cancel();
        }

        // 일시 정지 함수
        function pauseCounting() {
            if (!counting || paused) return;
            paused = true;
            window.speechSynthesis.pause();
        }

        // 재개 함수
        function resumeCounting() {
            if (!counting || !paused) return;
            paused = false;
            window.speechSynthesis.resume();
        }

        // 카운팅 함수
        function count() {
            if (!counting || paused) return;

            const endNumber = parseInt(endNumberInput.value);
            if (currentNumber > endNumber) {
                counting = false;
                return;
            }

            speakNumber(currentNumber);
            currentNumber++;

            // 음성 합성이 끝난 후 다음 숫자를 호출
            window.speechSynthesis.onend = () => {
                if (counting && !paused) {
                    count();
                }
            };
        }

        // 이벤트 리스너 등록
        document.getElementById("startBtn").addEventListener("click", startCounting);
        document.getElementById("stopBtn").addEventListener("click", stopCounting);
        document.getElementById("pauseBtn").addEventListener("click", pauseCounting);
        document.getElementById("resumeBtn").addEventListener("click", resumeCounting);
    </script>
</body>
</html>
